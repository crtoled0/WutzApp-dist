function MainModel(){var e=this,o={idx:0,colours:["success","default","primary","danger","warning","info"]};e.barLoaded=ko.observable(),e.config=ko.observable(),e.artists=ko.observableArray([]),e.albums=ko.observableArray([]),e.currSelected=ko.observable({artist:null,album:null}),e.getMessBox=ko.observable(),e.isSearchIndexing=ko.observable(!1),e.displayMainMod=ko.observable(!0),e.canRaiseSearch=ko.observable(!1),e.trans=function(e,o){return o?locale.trans(e,o):locale.trans(e)},e.displayGetMessage=function(o){e.getMessBox(o),$("#genericMessageBox").fadeIn(300).delay(3e3).fadeOut(500)},e.nextColor=function(){var e=o.colours[o.idx];return o.idx++,o.idx>=o.colours.length-1&&(o.idx=0),e},e.fillAlbums=function(o){e.albums([]);var n=e.barLoaded(),a=e.currSelected();a.artist=o,e.currSelected(a);var i=wtzCache.getAlbums(o.idartist);i?e.albums(i):(e.openLoading(),window.wutzAdmin.callService({service:"getAlbumPerArtist/"+n.idcatalog+"/"+o.idartist},function(n){e.closeLoading(),console.log(n);for(var a in n)n[a].lfm_img_url=n[a].lfm_img_url?n[a].lfm_img_url:"./img/logo.png",e.albums.push(n[a]);wtzCache.addAlbums(o.idartist,e.albums())})),$("#main-container-image .artists").slideUp(function(){$("#main-container-image .albums").slideDown(),$("#main-container-image .closeAlbumsSec").slideDown()})},e.closeAlbums=function(){$("#main-container-image .artists").slideDown(),$("#main-container-image .albums").slideUp(),$("#main-container-image .closeAlbumsSec").slideUp()},e.fillArtists=function(){e.artists([]);var o=e.barLoaded(),n=wtzCache.getArtists();n?e.artists(n):(e.openLoading(),window.wutzAdmin.callService({service:"getArtistList/"+o.idcatalog},function(o){e.closeLoading(),console.log(o);for(var n in o)o[n].lfm_img_url=o[n].lfm_img_url?o[n].lfm_img_url:"./img/logo.png",e.artists.push(o[n]);wtzCache.addArtists(e.artists())}))},e.init=function(){e.openLoading(),e.barLoaded()||$.get("json/config.json",function(o){console.log(o),e.config(o),e.openConnect2BarModel(),e.closeLoading()}),$("#filterInput").on("keyup",function(){setTimeout(function(){e.localSearch($("#filterInput").val())},0)})},e.openConnect2BarModel=function(){e.openLoading(),koMods.connect2Bar?($("#connect2BarContainer").modal({backdrop:"static",keyboard:!1}),e.closeLoading()):$.get("templates/connect2Bar.html",function(o){var n=$("<div>"+o+"</div>");$("body").append(n),koMods.connect2Bar=new Connect2BarModel,ko.applyBindings(koMods.connect2Bar,document.getElementById("connect2BarContainer")),koMods.connect2Bar.init(),$("#connect2BarContainer").modal({backdrop:"static",keyboard:!1}),e.closeLoading()})},e.openConnect2Bar=function(){e.openConnect2BarModel(),koMods.connect2Bar.justDisplayBarDetails(),$("#cross-menu").click()},e.openSongListModel=function(o,n){var a=n?null:o,i=n?o:null;if(e.openLoading(),a){var t=e.currSelected();t.album=a,e.currSelected(t)}koMods.songList?(a?koMods.songList.loadSongList():koMods.songList.loadSongList4Artist(i.idartist),$("#songListContainer").modal({backdrop:"static",keyboard:!1}),e.closeLoading()):$.get("templates/songList.html",function(o){var n=$("<div>"+o+"</div>");$("body").append(n),koMods.songList=new SongListModel,ko.applyBindings(koMods.songList,document.getElementById("songListContainer")),koMods.songList.init(),a?koMods.songList.loadSongList():koMods.songList.loadSongList4Artist(i.idartist),$("#songListContainer").modal({backdrop:"static",keyboard:!1}),e.closeLoading()})},e.openSearchResultModel=function(){var o=$("#filterInput").val();e.openLoading(),e.displayMainMod(!1),koMods.searchResult?(koMods.searchResult.applySearch(o),$("#main-container-image").fadeOut("slow"),$("#searchResultContainer").fadeIn("slow"),e.closeLoading()):$.get("templates/searchResult.html",function(n){var a=$("<div>"+n+"</div>");$("#main-container-image").parent().append(a),koMods.searchResult=new SearchResultModel,ko.applyBindings(koMods.searchResult,document.getElementById("searchResultContainer")),koMods.searchResult.init(),koMods.searchResult.applySearch(o),$("#main-container-image").fadeOut("slow"),$("#searchResultContainer").fadeIn("slow"),e.closeLoading()})},e.back2MainModel=function(){$("#main-container-image").fadeIn("slow"),$("#searchResultContainer").fadeOut("slow"),e.displayMainMod(!0),$("#filterInput").on("keyup",function(){setTimeout(function(){e.localSearch($("#filterInput").val())},0)}),e.localSearch($("#filterInput").val())},e.logOutBar=function(){$("#cross-menu").click(),e.barLoaded(null),e.artists([]),e.albums([]),e.openConnect2BarModel(),koMods.connect2Bar.refresh()},e.openLoading=function(){$("#loadingDiv").fadeIn("slow")},e.closeLoading=function(){$("#loadingDiv").fadeOut("slow")},e.localSearch=function(o){var o=o.toLowerCase().replace(/\s/gi,"");""===o?($(".work figure").show(),e.canRaiseSearch(!1)):o.length>=2&&(e.canRaiseSearch(!0),$(".work figure").hide(),$(".work figure").each(function(n){-1!==$(".itemName",$(this)).html().toLowerCase().replace(/\s/gi,"").indexOf(o)&&$(this).show(),$("#main-container-image .albums figure").length-$("#main-container-image .albums figure:hidden").length<=0?e.closeAlbums():($("#main-container-image .artists").hide(),$("#main-container-image .albums").show(),$("#main-container-image .closeAlbumsSec").show())}))},e.openMainMenu=function(){$("#main-container-menu").stop().animate({left:"0"},300)},e.closeMainMenu=function(){$("#main-container-menu").stop().animate({left:"-100%"},300)}}var koMods={};