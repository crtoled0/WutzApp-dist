function MainModel(){var e=this,n={idx:0,colours:["success","default","primary","danger","warning","info"]};e.barLoaded=ko.observable(),e.config=ko.observable(),e.artists=ko.observableArray([]),e.albums=ko.observableArray([]),e.currSelected=ko.observable({artist:null,album:null}),e.getMessBox=ko.observable(),e.isSearchIndexing=ko.observable(!1),e.displayMainMod=ko.observable(!0),e.canRaiseSearch=ko.observable(!1),e.trans=function(e,n){return n?locale.trans(e,n):locale.trans(e)},e.displayGetMessage=function(n){e.getMessBox(n),$("#genericMessageBox").fadeIn(300).delay(3e3).fadeOut(500)},e.nextColor=function(){var e=n.colours[n.idx];return n.idx++,n.idx>=n.colours.length-1&&(n.idx=0),e},e.fillAlbums=function(n){e.albums([]);var o=e.barLoaded(),a=e.currSelected();a.artist=n,e.currSelected(a);var i=wtzCache.getAlbums(n.idartist);i?e.albums(i):(e.openLoading(),window.wutzAdmin.callService({service:"getAlbumPerArtist/"+o.idcatalog+"/"+n.idartist},function(o){e.closeLoading(),console.log(o);for(var a in o)o[a].lfm_img_url=o[a].lfm_img_url?o[a].lfm_img_url:"./img/logo.png",e.albums.push(o[a]);wtzCache.addAlbums(n.idartist,e.albums())})),$("#main-container-image .artists").slideUp(function(){$("#main-container-image .albums").slideDown(),$("#main-container-image .closeAlbumsSec").slideDown()})},e.closeAlbums=function(){$("#main-container-image .artists").slideDown(),$("#main-container-image .albums").slideUp(),$("#main-container-image .closeAlbumsSec").slideUp()},e.fillArtists=function(){e.artists([]);var n=e.barLoaded(),o=wtzCache.getArtists();o?e.artists(o):(e.openLoading(),window.wutzAdmin.callService({service:"getArtistList/"+n.idcatalog},function(n){e.closeLoading(),console.log(n);for(var o in n)n[o].lfm_img_url=n[o].lfm_img_url?n[o].lfm_img_url:"./img/logo.png",e.artists.push(n[o]);wtzCache.addArtists(e.artists()),e.isSearchIndexing(!0),setTimeout(function(){wtzCache.startIndexingCatalog()},0),wtzCache.onCatalogIndexed(function(){e.isSearchIndexing(!1)})}))},e.init=function(){e.openLoading(),e.barLoaded()||$.get("json/config.json",function(n){console.log(n),e.config(n),e.openConnect2BarModel(),e.closeLoading()}),$("#filterInput").on("keyup",function(){setTimeout(function(){e.localSearch($("#filterInput").val())},0)})},e.openConnect2BarModel=function(){e.openLoading(),koMods.connect2Bar?($("#connect2BarContainer").modal({backdrop:"static",keyboard:!1}),e.closeLoading()):$.get("templates/connect2Bar.html",function(n){var o=$("<div>"+n+"</div>");$("body").append(o),koMods.connect2Bar=new Connect2BarModel,ko.applyBindings(koMods.connect2Bar,document.getElementById("connect2BarContainer")),koMods.connect2Bar.init(),$("#connect2BarContainer").modal({backdrop:"static",keyboard:!1}),e.closeLoading()})},e.openConnect2Bar=function(){e.openConnect2BarModel(),koMods.connect2Bar.justDisplayBarDetails(),$("#cross-menu").click()},e.openSongListModel=function(n){e.openLoading();var o=e.currSelected();o.album=n,e.currSelected(o),koMods.songList?(koMods.songList.loadSongList(),$("#songListContainer").modal({backdrop:"static",keyboard:!1}),e.closeLoading()):$.get("templates/songList.html",function(n){var o=$("<div>"+n+"</div>");$("body").append(o),koMods.songList=new SongListModel,ko.applyBindings(koMods.songList,document.getElementById("songListContainer")),koMods.songList.init(),koMods.songList.loadSongList(),$("#songListContainer").modal({backdrop:"static",keyboard:!1}),e.closeLoading()})},e.openSearchResultModel=function(){var n=$("#filterInput").val();e.openLoading(),e.displayMainMod(!1),koMods.searchResult?(koMods.searchResult.applySearch(n),$("#main-container-image").fadeOut("slow"),$("#searchResultContainer").fadeIn("slow"),e.closeLoading()):$.get("templates/searchResult.html",function(o){var a=$("<div>"+o+"</div>");$("#main-container-image").parent().append(a),koMods.searchResult=new SearchResultModel,ko.applyBindings(koMods.searchResult,document.getElementById("searchResultContainer")),koMods.searchResult.init(),koMods.searchResult.applySearch(n),$("#main-container-image").fadeOut("slow"),$("#searchResultContainer").fadeIn("slow"),e.closeLoading()})},e.back2MainModel=function(){$("#main-container-image").fadeIn("slow"),$("#searchResultContainer").fadeOut("slow"),e.displayMainMod(!0),$("#filterInput").on("keyup",function(){setTimeout(function(){e.localSearch($("#filterInput").val())},0)}),e.localSearch($("#filterInput").val())},e.logOutBar=function(){$("#cross-menu").click(),e.barLoaded(null),e.artists([]),e.albums([]),e.openConnect2BarModel(),koMods.connect2Bar.refresh()},e.openLoading=function(){$("#loadingDiv").fadeIn("slow")},e.closeLoading=function(){$("#loadingDiv").fadeOut("slow")},e.localSearch=function(n){var n=n.toLowerCase().replace(/\s/gi,"");""===n?($(".work figure").show(),e.canRaiseSearch(!1)):n.length>=2&&(e.canRaiseSearch(!0),$(".work figure").hide(),$(".work figure").each(function(o){-1!==$(".itemName",$(this)).html().toLowerCase().replace(/\s/gi,"").indexOf(n)&&$(this).show(),$("#main-container-image .albums figure").length-$("#main-container-image .albums figure:hidden").length<=0?e.closeAlbums():($("#main-container-image .artists").hide(),$("#main-container-image .albums").show(),$("#main-container-image .closeAlbumsSec").show())}))},e.openMainMenu=function(){$("#main-container-menu").stop().animate({left:"0"},300)},e.closeMainMenu=function(){$("#main-container-menu").stop().animate({left:"-100%"},300)}}var koMods={};