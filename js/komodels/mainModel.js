function MainModel(){var o=this,n={idx:0,colours:["success","default","primary","danger","warning","info"]};o.barLoaded=ko.observable(),o.config=ko.observable(),o.artists=ko.observableArray([]),o.albums=ko.observableArray([]),o.currSelected=ko.observable({artist:null,album:null}),o.getMessBox=ko.observable(),o.isSearchIndexing=ko.observable(!1),o.displayMainMod=ko.observable(!0),o.canRaiseSearch=ko.observable(!1),o.trans=function(o,n){return n?locale.trans(o,n):locale.trans(o)},o.displayGetMessage=function(n){o.getMessBox(n),$("#genericMessageBox").fadeIn(300).delay(3e3).fadeOut(500)},o.nextColor=function(){var o=n.colours[n.idx];return n.idx++,n.idx>=n.colours.length-1&&(n.idx=0),o},o.fillAlbums=function(n){o.albums([]);var e=o.barLoaded(),a=o.currSelected();a.artist=n,o.currSelected(a);var i=wtzCache.getAlbums(n.idartist);i?o.albums(i):(o.openLoading(),window.wutzAdmin.callService({service:"getAlbumPerArtist/"+e.idcatalog+"/"+n.idartist},function(e){o.closeLoading(),console.log(e);for(var a in e)e[a].lfm_img_url=e[a].lfm_img_url?e[a].lfm_img_url:"./img/logo.png",o.albums.push(e[a]);wtzCache.addAlbums(n.idartist,o.albums())})),$("#main-container-image .artists").slideUp(function(){$("#main-container-image .albums").slideDown(),$("#main-container-image .closeAlbumsSec").slideDown()})},o.closeAlbums=function(){$("#main-container-image .artists").slideDown(),$("#main-container-image .albums").slideUp(),$("#main-container-image .closeAlbumsSec").slideUp()},o.fillArtists=function(){o.artists([]);var n=o.barLoaded(),e=wtzCache.getArtists();e?o.artists(e):(o.openLoading(),window.wutzAdmin.callService({service:"getArtistList/"+n.idcatalog},function(n){o.closeLoading(),console.log(n);for(var e in n)n[e].lfm_img_url=n[e].lfm_img_url?n[e].lfm_img_url:"./img/logo.png",o.artists.push(n[e]);wtzCache.addArtists(o.artists())}))},o.init=function(){o.openLoading(),o.barLoaded()||$.get("json/config.json",function(n){console.log(n),o.config(n),o.openConnect2BarModel(),o.closeLoading()})},o.openConnect2BarModel=function(){o.openLoading(),koMods.connect2Bar?($("#connect2BarContainer").modal({backdrop:"static",keyboard:!1}),o.closeLoading()):$.get("templates/connect2Bar.html",function(n){var e=$("<div>"+n+"</div>");$("body").append(e),koMods.connect2Bar=new Connect2BarModel,ko.applyBindings(koMods.connect2Bar,document.getElementById("connect2BarContainer")),koMods.connect2Bar.init(),$("#connect2BarContainer").modal({backdrop:"static",keyboard:!1}),o.closeLoading()})},o.openConnect2Bar=function(){o.openConnect2BarModel(),koMods.connect2Bar.justDisplayBarDetails(),$("#cross-menu").click()},o.openSongListModel=function(n,e){var a=e?null:n,i=e?n:null;if(o.openLoading(),a){var t=o.currSelected();t.album=a,o.currSelected(t)}koMods.songList?(a?koMods.songList.loadSongList():koMods.songList.loadSongList4Artist(i.idartist),$("#songListContainer").modal({backdrop:"static",keyboard:!1}),o.closeLoading()):$.get("templates/songList.html",function(n){var e=$("<div>"+n+"</div>");$("body").append(e),koMods.songList=new SongListModel,ko.applyBindings(koMods.songList,document.getElementById("songListContainer")),koMods.songList.init(),a?koMods.songList.loadSongList():koMods.songList.loadSongList4Artist(i.idartist),$("#songListContainer").modal({backdrop:"static",keyboard:!1}),o.closeLoading()})},o.loadSongListModel=function(n){o.openLoading(),koMods.songList||$.get("templates/songList.html",function(e){var a=$("<div>"+e+"</div>");$("body").append(a),koMods.songList=new SongListModel,ko.applyBindings(koMods.songList,document.getElementById("songListContainer")),koMods.songList.init(),o.closeLoading(),n()})},o.openSearchResultModel=function(){var n=$("#filterInput").val();o.openLoading(),o.displayMainMod(!1),koMods.searchResult?(koMods.searchResult.applySearch(n),$("#main-container-image").fadeOut("slow"),$("#searchResultContainer").fadeIn("slow"),o.closeLoading()):$.get("templates/searchResult.html",function(e){var a=$("<div>"+e+"</div>");$("#main-container-image").parent().append(a),koMods.searchResult=new SearchResultModel,ko.applyBindings(koMods.searchResult,document.getElementById("searchResultContainer")),koMods.searchResult.init(),koMods.searchResult.applySearch(n),$("#main-container-image").fadeOut("slow"),$("#searchResultContainer").fadeIn("slow"),o.closeLoading()})},o.back2MainModel=function(){$("#main-container-image").fadeIn("slow"),$("#searchResultContainer").fadeOut("slow"),o.displayMainMod(!0)},o.logOutBar=function(){$("#cross-menu").click(),o.barLoaded(null),o.artists([]),o.albums([]),o.openConnect2BarModel(),koMods.connect2Bar.refresh()},o.openLoading=function(){$("#loadingDiv").fadeIn("slow")},o.closeLoading=function(){$("#loadingDiv").fadeOut("slow")},o.localSearch=function(n){var n=n.toLowerCase().replace(/\s/gi,"");""===n?($(".work figure").show(),o.canRaiseSearch(!1)):n.length>=2&&(o.canRaiseSearch(!0),$(".work figure").hide(),$(".work figure").each(function(e){-1!==$(".itemName",$(this)).html().toLowerCase().replace(/\s/gi,"").indexOf(n)&&$(this).show(),$("#main-container-image .albums figure").length-$("#main-container-image .albums figure:hidden").length<=0?o.closeAlbums():($("#main-container-image .artists").hide(),$("#main-container-image .albums").show(),$("#main-container-image .closeAlbumsSec").show())}))},o.openMainMenu=function(){$("#main-container-menu").stop().animate({left:"0"},300)},o.closeMainMenu=function(){$("#main-container-menu").stop().animate({left:"-100%"},300)}}var koMods={};